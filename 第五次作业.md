#第五次作业--频域滤波器
####姓名：林袁钰
####班级：自动化66班 
####学号：21606504138

##摘要
数字图像本质上是数字信号，图像的滤波就是对信号的不同频率进行筛选，体现在图像上，模糊操作实际上就是抑制高频，钝化操作实际是抑制低频。所以在频域上对图像信号做处理更贴近信号处理的本质。本次实验主要利用matlab完成了频域低通滤波器（包括butterworth and Gaussian）；频域高通滤波器（包括butterworth and Gaussian）以及其他高通滤波器，分别对示例图像做滤波处理，比较分析各自的优缺点。最后统一比较讨论空域滤波与频域滤波的关系。  

***
##关键词
matlab; butterworth; gaussian; 高通滤波器，低通滤波器；拉普拉斯滤波器；unmask滤波器等。  

##作业内容
###1频域低通滤波器：设计低通滤波器包括 butterworth and Gaussian (选择合适的半径，计算功率谱比),平滑测试图像test1和2;分析各自优缺点；
* **频域低通滤波有关知识**  
*1.巴特沃斯低通滤波器：*  
截止频率位于距原点D0处的n阶巴特沃斯低通滤波器的传递函数H(u，v)如下所示：  
H(u,v)=1/{[1+D(u,v)/D0]^(2*n)}  
其中，D（u，v）=[(u-P/2)^2+(v-Q/2)^2]^(1/2);   
此传递函数并没有在通过频率和滤除频率之间给出明显截止的尖锐的不连续性。对于具有平滑传递函数的滤波器，可在这样一点定义截止频率，即是的H（u,v）下降到最大值的某个百分点。对于上式，截止频率点是当D（u,v）=D0时的点。   
二阶巴特沃斯是在有效的低通滤波和可接受的振铃特性之间的较好折中。因此本次实验中选用二阶巴特沃斯低通滤波器。  
*2.高斯低通滤波器：*  
高斯低通滤波器的传递函数如下所示：  
H(u,v)=exp((-D(u,v))^2/2/D0^2);  
其中，D（u，v）是距离频率域矩形中心的距离，D0是截止频率。当D（u,v）=D0时，GLPF下降到最大值的0.707处。
*3.功率谱*  
建立一组标准截止频率轨迹的一种方法是计算包含回顶的总图像功率值Pt的圆。该值是通过求每个点填充后的图像功率谱分量和得到的。功率谱的定义为：  
P（u，v）=|F（u，v|^2=[R(u，v))]^2+[I(u，v))]^2;  
R和I分别是F的实部和虚部，并且所有计算直接对离散变量u=0：PP-1；v=1：	Q-1;如果DFT已被中心化，那么远点位于频率矩形中心处，半径为D0的圆包含a%的功率。  
* **调用函数说明**  
fft2函数用于数字图像的二维傅里叶变换；  
ifft2函数用于数字图像的二位傅里叶反变换；  
fftshift函数用于将变换后的频谱中心从矩阵原点移到矩阵的中心。  
* **实验代码**   
实验代码在附件butterworthLowPass与GaussLowPass中。  
* **实验结果**  
注：以下图片分别为D0=25和75的高斯低通滤波器的图像处理结果和傅里叶谱图。  、
D0=75 功率谱比计算结果为L1（test1）=0.9925，L2（test2）=0.9902  
![q1-1](./photo/q11/01.png)  
![q1-2](./photo/q11/02.png)  
![q1-3](./photo/q11/03.png)  
![q1-4](./photo/q11/04.png)  
![q1-5](./photo/q11/05.png)  
![q1-6](./photo/q11/06.png)  
D0=25 功率谱比计算结果为L1（test1）=0.9657，L2（test2）=0.9754
![q1-7](./photo/q11/07.png)  
![q1-8](./photo/q11/08.png)  
![q1-9](./photo/q11/09.png)  
![q1-10](./photo/q11/10.png)  
![q1-11](./photo/q11/11.png)  
![q1-12](./photo/q11/12.png)   
注：以下图片分别为D0=25和75的巴特沃斯低通滤波器的图像处理结果和傅里叶谱图。  
D0=75 功率谱比计算结果为L1（test1）=0.9957，L2（test2）=0.9916
![q2-1](./photo/q12/01.png)  
![q2-2](./photo/q12/02.png)  
![q2-3](./photo/q12/03.png)  
![q2-4](./photo/q12/04.png)  
![q2-5](./photo/q12/05.png)  
![q2-6](./photo/q12/06.png)  
D0=25 功率谱比计算结果为L1（test1）=0.9741，L2（test2）=0.9804
![q2-7](./photo/q12/07.png)  
![q2-8](./photo/q12/08.png)  
![q2-9](./photo/q12/09.png)  
![q2-10](./photo/q12/10.png)  
![q2-11](./photo/q12/11.png)  
![q2-12](./photo/q12/12.png)  

* **结果分析:**  
对比每组图像结果可以发现，低通滤波器具有较明显的平滑效果。观察图像的傅里叶谱图可以发现，滤波在空间域是相乘关系，低通滤波器的低频分量可以通过，而高频分量不行通过。由此可以清晰的看出低通滤波器的截断效果。  
对比同组图像不同D0可以发现，截止频率D0减小，滤波后的图像越来越模糊，功率普越来越小。即滤波后的低频分量越来越小。  
对比不同组（即对比巴特沃斯滤波器和高斯滤波器）可以发现，两种滤波器对图像的滤波效果基本一致，即平滑图像，滤除高频分量，保有低频分量。  
优缺点：  
巴特沃斯滤波器伴随有振铃现象，且阶数越高，振铃现象越明显。而高斯滤波器的过度特性非常平坦，不会产生振铃现象。 理想低通滤波器的滤波非常尖锐，而高斯低通的滤波较为平滑，而巴特沃斯低通滤波器则介于两者之间，阶数越大越接近理想滤波器，越小越接近高斯滤波器。  但从图像上看而这滤波效果较为相同，但频率谱来说，高斯滤波器较小，即对应其较为平滑的特性。  

###2频域高通滤波器：设计高通滤波器包括butterworth and Gaussian，在频域增强边缘。选择半径和计算功率谱比，测试图像test3,4：分析各自优缺点；  

* **高通滤波器有关知识**  
高斯滤波器是一种根据高斯函数形状来选择模板权值的线性平滑滤波方法。高斯平滑滤波器对于去除服从正态分布的噪声有极大的效果。  
*1.巴特沃斯高通滤波器：*  
截止频率位于距原点D0处的n阶巴特沃斯高通滤波器的传递函数为  
H（u,v）=1/[1+((D0/D(u,v))^2*n)];  
此传递函数并没有再通过频率和滤波频率之间给出明显截至的尖锐的不连续性，当D（u,v）=D0时；H（u，v）从最大值1下降为50%。  
*2.高斯高通滤波器：*  
其传递函数如下所示：  
H(u,v)=1-exp((-D(u,v))^2/2/D0^2);  
能下降到其最大值的0.607处。  

* **实验代码**  
实验代码在附件butterworthHighPass与GaussHighPass中。    

* **实验结果**  
注：以下图片分别为D0=25和75的高斯高通通滤波器的图像处理结果和傅里叶谱图。  
D0=75 功率谱比计算结果为L1（test3）=6.8038e-05，L2（test4）=6.5073e-04
![q3-1](./photo/q21/01.png)  
![q3-2](./photo/q21/02.png)  
![q3-3](./photo/q21/03.png)  
![q3-4](./photo/q21/04.png)  
![q3-5](./photo/q21/05.png)  
![q3-6](./photo/q21/06.png)  
D0=25 功率谱比计算结果为L1（test3）=0.0019，L2（test4）=0.0057
![q3-7](./photo/q21/07.png)  
![q3-8](./photo/q21/08.png)  
![q3-9](./photo/q21/09.png)  
![q3-10](./photo/q21/10.png)  
![q3-11](./photo/q21/11.png)  
![q3-12](./photo/q21/12.png)  

注：以下图片分别为D0=25和75的巴特沃斯高通通滤波器的图像处理结果和傅里叶谱图。  
D0=75 功率谱比计算结果为L1（test3）=4.7629e-05，L2（test4）=7.3564e-04  
![q4-1](./photo/q22/01.png)  
![q4-2](./photo/q22/02.png)  
![q4-3](./photo/q22/03.png)  
![q4-4](./photo/q22/04.png)  
![q4-5](./photo/q22/05.png)  
![q4-6](./photo/q22/06.png)  
D0=25 功率谱比计算结果为L1（test3）=0.0022，L2（test4）=0.0071  
![q4-7](./photo/q22/07.png)  
![q4-8](./photo/q22/08.png)  
![q4-9](./photo/q22/09.png)  
![q4-10](./photo/q22/10.png)  
![q4-11](./photo/q22/11.png)  
![q4-12](./photo/q22/12.png)  

* **结果分析**  
对比每组图像可以发现，高通滤波器具有较明显的边缘增强效果。并且可以发现，滤波在空间与是卷积和，在频域是相乘关系。高通滤波器对于低频分量有很强的滤除作用，并且保留高频分量。  
对比每组图像的不同D0值可以发现，随着截止频率D0的增大，滤波后的图像边缘越来越不清晰，功率谱也越来越大。即滤波后的高频分量越来越多。 当D0为75时，完全看不见边缘，这是因为滤除的低频分量太多，导致图像全部变成了黑色。  
对比巴特沃斯高通滤波器和高斯高通滤波器可以发现，发现二者的滤波效果几乎一致，即达到边缘增强的效果。通过高通滤波器，数字图像被滤除低频分量，保留高频份量。  
优缺点：  
对比巴特沃斯滤波器和高斯滤波器的优缺点，已于问题1中说明故于此不赘述。  
###3其他高通滤波器：拉普拉斯和Unmask，对测试图像test3,4滤波；分析各自优缺点；  
*1.laplace滤波器有关知识：*  
拉普拉斯算子可使用如下滤波器在频率域实现：  
H（u,v）=4*pi[(u-P/2)^2+（v-Q/2）^2]=-4*PI^2*(D(u,v))^2;  
式中，D（u,v）时距离函数，拉普拉斯图像有H与F相乘的反拉普拉斯变换得到。  
*2.unmask滤波器有关知识：*  

 
**2  实验代码：**  
实验代码在附件laplaceHighPass与unmaskHighPass中。  

**3 实验结果：**  
注：以下是laplace高通滤波结果：  
![q5-1](./photo/q31/01.png)  
![q5-2](./photo/q31/02.png)  
![q5-3](./photo/q31/03.png)  
![q5-4](./photo/q31/04.png)  
![q5-5](./photo/q31/05.png)  
![q5-6](./photo/q31/06.png)  
注： 以下是unmask高通滤波结果：  
![q5-7](./photo/q32/01.png)  
![q5-8](./photo/q32/02.png)  
![q5-9](./photo/q32/03.png)  
![q5-10](./photo/q32/04.png)  
![q5-11](./photo/q32/05.png)  
![q5-12](./photo/q32/06.png)  


* **结果分析**  
对比每组图像处理结果可以发现图像边缘增强，符合高通滤波器的特性。  但拉普拉斯高通滤波器得出的结果较不理想，经查证乃是没有进行归一化处理。  

###4. 比较并讨论空域低通高通滤波（Project3）与频域低通和高通的关系；
空间域和频率域之间的纽带是卷积定理。在空间域由滤波函数h和f进行卷积从而完成空间域滤波，在频率域由滤波函数H和F进行相乘完成空间域滤波。但图像的滤波就是对信号的不同频率进行筛选，体现在图像上，模糊操作实际上就是抑制高频，钝化操作实际是抑制低频。所以在频域上对图像信号做处理更贴近信号处理的本质。  
由此可知，许多空域滤波技术或空域增强技术等可以转化到频域实现。综合前几次实验可以发现，空间滤波主要包括平滑滤波和钝化滤波，频率域则主要是平滑模糊和边缘增强。  
空间域的平滑滤波是滤除不规则噪声和干扰，从频域角度来看，不规则噪声一般具有较高频率，所以可用频域滤波器的低通滤波器来处理；钝化滤波是要增强边缘和轮廓，从频域角度看，边缘一般具有较高的频率，可用频域滤波器的高通滤波器来保留高频部分，滤除低频部分。  由此可见，空域和频域滤波有着极大的联系。  

###附录
【参考文献】  
[1]冈萨雷斯，数字图像处理第三版，北京，电子工业出版社，2011  
[2]周品，MATLAB数字图像处理，北京，清华大学出版社，2012  